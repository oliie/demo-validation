<script lang="ts">
	import '@picocss/pico/css/pico.pumpkin.min.css';
	import { UserSchema } from '$lib/user.schema';

	let payload = {};

	let name = '';
	let email = '';
	let password = '';
	let passwordValidation = '';

	let errorMessage = '';

	function handleSubmit() {
		const validForm = UserSchema.safeParse({
			name,
			email,
			password,
			passwordValidation
		});

		console.log(validForm);

		if (!validForm.success) {
			errorMessage = 'FormulÃ¤ret Ã¤r inte korrekt ifyllt! ðŸ˜­';
			throw new Error(errorMessage);
		}

		errorMessage = '';
		payload = {
			name,
			email,
			password,
			passwordValidation
		};
	}
</script>

<header>
	<h1>pixel<span class="and">&</span>code_ ðŸš€ Form-validering</h1>
</header>

<main class="container">
	<form class="user-form" on:submit|preventDefault={handleSubmit}>
		<input type="text" bind:value={name} name="name" placeholder="Namn" aria-invalid="false" />

		<input type="email" bind:value={email} name="email" placeholder="E-post" />

		<input type="text" bind:value={password} name="password" placeholder="LÃ¶senord" />

		<input
			type="text"
			bind:value={passwordValidation}
			name="password-validation"
			id="password-validation"
			placeholder="LÃ¶senord igen"
		/>

		<button type="submit">Skapa anvÃ¤ndare</button>
	</form>

	{#if errorMessage}
		<p>{errorMessage}</p>
	{:else}
		{JSON.stringify(payload)}
	{/if}
</main>

<style>
	.and {
		color: #ec7454;
	}

	h1 {
		margin-top: 4rem;
		margin-bottom: 2rem;
		text-align: center;
	}
</style>
